<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Память о погибших</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-neutral-950 text-neutral-100 min-h-screen">

  <header class="border-b border-neutral-800 bg-neutral-900">
    <div class="max-w-5xl mx-auto px-6 py-6">
      <h1 class="text-3xl font-semibold">Память о погибших во Второй мировой войне</h1>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-6 py-10 space-y-8">

    <!-- Поиск -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">Поиск</h2>
      <input
        id="searchInput"
        type="text"
        placeholder="Введите фамилию..."
        class="w-full bg-neutral-900 border border-neutral-800 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-white/20"
      />
    </section>

    <!-- Список погибших -->
    <section>
      <h2 class="text-xl font-semibold mb-4">Список погибших</h2>
      <div id="fallenList" class="grid md:grid-cols-2 gap-6"></div>
    </section>

  </main>

  <script>
    const listEl = document.getElementById("fallenList");
    const searchInput = document.getElementById("searchInput");

    async function loadFallen(query = "") {
      try {
        const url = query
          ? `http://127.0.0.1:8000/api/fallen/?search=${query}`
          : "http://127.0.0.1:8000/api/fallen/";

        const response = await fetch(url);
        const data = await response.json();

        listEl.innerHTML = "";

        data.forEach(person => {
          const card = document.createElement("div");
          card.className = "bg-neutral-900 border border-neutral-800 rounded-2xl p-6";

          card.innerHTML = `
            <h3 class="text-lg font-semibold">${person.name}</h3>
            <p class="text-neutral-400 text-sm">${person.birth_year ?? "?"} — ${person.death_year ?? "?"}</p>
            <p class="mt-2 text-neutral-300 text-sm">${person.description ?? ""}</p>
          `;

          listEl.appendChild(card);
        });
      } catch (err) {
        console.error("Ошибка загрузки:", err);
      }
    }

    searchInput.addEventListener("input", e => {
      loadFallen(e.target.value);
    });

    loadFallen();
  </script>

</body>
</html>